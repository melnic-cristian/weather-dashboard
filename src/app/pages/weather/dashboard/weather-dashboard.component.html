<div class="weather">
  <div class="weather__header">
    <span class="weather__title">Weather Dashboard</span>
    <span class="weather__subtitle">Historical temperature data visualization</span>
  </div>

  <div class="weather__section weather__section--location">
    <h2 class="weather__section-title">Select Location</h2>
    <div class="weather__controls">
      <div class="weather__control">
        <label for="location" class="weather__label">Location:</label>
        <select
          id="location"
          [ngModel]="selectedLocation()"
          (ngModelChange)="selectedLocation.set($event); onLocationChange()"
          class="weather__select weather__select--location"
          [disabled]="isLoading()"
        >
          <option value="" disabled>Choose a location</option>
          @for (location of predefinedLocations; track $index) {
            <option [ngValue]="location">{{ location.name }}</option>
          }
        </select>
      </div>

      <div class="weather__control">
        <label for="days" class="weather__label">Days of history:</label>
        <select
          id="days"
          [ngModel]="selectedDays()"
          (ngModelChange)="selectedDays.set($event); loadWeatherData()"
          class="weather__select weather__select--days"
          [disabled]="isLoading() || !selectedLocation()"
        >
          <option value="" disabled>Choose a range</option>
          @for (range of ranges; track $index) {
            <option [ngValue]="range">{{ range }}</option>
          }
        </select>
      </div>
    </div>
  </div>

  <div class="weather__section weather__section--chart">
    @if (isLoading()) {
      <app-loading-spinner message="Fetching weather data..."></app-loading-spinner>
    }

    @if (error() && !isLoading()) {
      <app-error-message title="Weather Data Error" (message)="error()" (retry)="loadWeatherData()"></app-error-message>
    }

    @if (!isLoading() && !error()) {
      <div class="weather__chart">
        <h3 class="weather__chart-title">Temperature Trends - {{ selectedLocation().name }}</h3>
        <canvas #chartCanvas class="weather__canvas"></canvas>
        <div class="weather__chart-info">
          <span class="weather__chart-description">
            Showing {{ selectedDays() }} days of historical temperature data
          </span>
          <div class="weather__legend">
            <span class="weather__legend-item weather__legend-item--max">
              <span class="weather__legend-color"></span>
              Maximum Temperature
            </span>
            <span class="weather__legend-item weather__legend-item--min">
              <span class="weather__legend-color"></span>
              Minimum Temperature
            </span>
          </div>
        </div>
      </div>
    }
  </div>
</div>
